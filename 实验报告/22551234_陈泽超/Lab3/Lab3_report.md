# 实验三：课程报告

姓名：陈泽超
学号：22551014

### 三篇论文的核心思想总结

这三篇论文不约而同地对传统单体、通用目的操作系统（如 Linux）的设计提出了挑战，并分别从硬件、数据和安全三个维度出发，探索了下一代操作系统的形态。

1.  **LegoOS：面向硬件资源分解的操作系统**
    * **核心问题：** 传统的“单体服务器”架构（CPU、内存、存储紧密耦合）导致了资源利用率低下、弹性差和故障域大等问题。
    * **核心思想：** 随着高速网络（如 RDMA）的发展，未来的数据中心硬件将走向“分解”（Disaggregation），即 CPU、内存、存储等将成为通过网络互连的独立组件。
    * **解决方案：** LegoOS 提出了一种名为“Splitkernel” (分解内核) 的新 OS 架构。OS 自身的功能被“分发”到各个硬件组件上，由各自的“监视器”（Monitor）来管理（如进程监视器、内存监视器）。其关键设计是通过在 CPU 组件上设置一个小型本地“ExCache”来弥合访问远程网络内存的性能鸿沟。
    * **贡献：** 证明了 OS 可以被分解以匹配分解的硬件，从而在获得更高资源利用率和更好故障隔离的同时，保持与传统 Linux 相当的性能。

2.  **DBOS：以数据库为中心的操作系统**
    * **核心问题：** 现有的 OS 架构（如 Linux）基于半个世纪前的“一切皆文件”模型，已不适应现代数据中心“集群即计算机”的规模。管理集群 OS 的状态本身已成为一个“大数据”问题，而现有的“Linux + Kubernetes”两层栈集成不佳。
    * **核心思想：** 彻底改变 OS 的核心抽象，从“一切皆文件”转向 **“一切皆表格”**。
    * **解决方案：** DBOS 提议在一个高性能、分布式的事务型 DBMS 基础上构建整个操作系统。在这个架构中，DBMS 成为 L2（第二层）的核心，提供了事务、高可用性和恢复等复杂功能。而传统的 OS 服务（如调度器、文件系统、IPC）则作为 L3（第三层）的“应用”，通过 SQL 查询和用户定义函数来实现。
    * **贡献：** 证明了 OS 服务可以被极大地简化（例如，调度器可以是一个简单的 SQL 查询），同时免费获得了强大的可观测性（所有 OS 状态都可查询）、分析能力和数据溯源功能，且性能与现有系统相比具有竞争力。

3.  **FlexOS：追求灵活隔离的操作系统**
    * **核心问题：** 现代 OS 在“设计时”就被锁死在一种特定的安全和隔离策略中（例如，用户/内核分离）。这种僵化的设计无法满足应用多样化的安全/性能需求，也难以适应新硬件隔离机制（如 Intel MPK）的出现和旧机制被攻破（如 Meltdown）的窘境 。
    * **核心思想：** 将安全和隔离策略的选择权从“设计时”推迟到“编译/部署时”。
    * **解决方案：** FlexOS 是一个基于 Unikraft 模块化 LibOS 构建的系统。它在源代码中使用“抽象调用门”和“数据注解”，并通过一个强大的**构建时工具链**，根据用户的配置文件，将这些抽象实现为特定的隔离后端（如无隔离、MPK 轻量级隔离或 EPT/VM 强隔离）。
    * **贡献：** 证明了 OS 可以在一个广阔的安全-性能空间中进行灵活配置。它还提供了一种“部分安全排序”（Partial Safety Ordering）技术，能半自动地帮助用户在给定的性能预算下，找到最安全的 OS 配置。

### 对操作系统未来发展方向的理解

这三篇论文共同指向了一个清晰的未来：**“一体适用”(One-Size-Fits-All) 的通用操作系统正在走向终结，取而代之的将是高度专业化、可定制化和数据驱动的操作系统。**

1.  **从“通用”到“专用” (Specialization)：**
    * 三篇论文都反对“一个内核统治一切”的模式。LegoOS 将 OS **专用化**以适应分解的硬件；DBOS 将 OS **专用化**以解决集群的状态管理问题；FlexOS 允许用户将 OS **专用化**以满足特定应用的安全与性能需求。
    * 未来，我们不会只有一个 Linux，而是会针对不同的应用场景（如数据中心、边缘、IoT）和硬件形态（如分解式、异构）拥有不同的、高度优化的 OS 内核和架构。

2.  **核心抽象的演进 (New Abstractions)：**
    * “进程”和“文件”这两个长达 50 年的抽象已不足以应对现代计算的复杂性。DBOS 提出的“一切皆表格”是一个极具吸引力的方向，它将 OS 的核心职责从“管理进程”转变为“管理分布式状态”。LegoOS 则将“服务器”抽象解构为由 vNode 组成的、跨物理边界的资源池。

3.  **OS 功能的“外溢” (Dissemination)：**
    * 传统上紧密耦合在内核中的 OS 功能正在向外“溢出”。LegoOS 将内存管理等功能“分发”到网络上的硬件监视器中；DBOS 将调度和文件系统“提升”为在 DBMS 之上运行的应用；FlexOS 将 OS 功能“库化”(LibOS)，使其与应用代码平级，并可被灵活（隔离）组合。

4.  **硬件-软件协同设计 (Co-Design)：**
    * OS 的发展不再是纯软件问题，而是与硬件紧密协同。LegoOS 的 Splitkernel 架构完全依赖于分解式硬件和高速网络；FlexOS 的设计使其能充分利用 Intel MPK 等新型 CPU 安全特性，而这是传统内核难以做到的。

### 面向边缘计算网络系统与 ML 网络的 OS 展望

我的研究领域（边缘计算网络系统和 Networks For ML）具有**极端异构、资源受限、高度分布式、低延迟敏感和安全需求多样**的特点。上述论文中的思想为解决这些挑战提供了关键线索。

1.  **DBOS 思想：赋能边缘状态管理**
    * 边缘计算的核心挑战之一是在海量、地理分散的节点间管理状态。DBOS 的“一切皆表格”理念是构建边缘 OS 的理想基础。
    * **展望：** 未来的边缘 OS 可以是一个**分布式的、以数据为中心**的平台。它可以将所有边缘资源（如节点位置、GPU/TPU 等加速器状态、网络链路质量、传感器数据流）全部建模为**分布式表格**。
    * **应用（ML 网络）：** 当一个 ML 任务需要调度时，调度器不再是运行复杂算法的黑盒，而是一个简单的 SQL 查询。例如：`SELECT node_id FROM nodes WHERE gpu_free > 4GB AND latency_to_camera < 10ms ORDER BY cost LIMIT 1`。
    * **应用（数据溯源）：** 在 Networks for ML 中，数据和模型的溯源至关重要。DBOS 架构能以事务方式自动记录每一次数据传输、处理和模型推理，提供端到端的数据可观测性。

2.  **FlexOS 思想：应对边缘的多样化需求**
    * 边缘环境的需求是冲突的：一个微小的 IoT 传感器需要极致的轻量化（接近零开销）；而一个承载多租户 ML 模型的边缘服务器则需要银行级的强隔离。
    * **展望：** FlexOS 的 **“编译时灵活隔离”** 理念是解决这一冲突的完美方案。
    * **应用（异构设备）：** 我们可以为传感器编译一个“无隔离”的 FlexOS 镜像，只包含应用和一个极简的网络栈。同时，为多租户边缘服务器编译一个启用 EPT/VM 强隔离后端的镜像，确保租户间的 ML 模型互不干扰。
    * **应用（ML 管道安全）：** 一个 ML 推理服务通常包含“数据预处理（如解析） -> 模型推理 -> 后处理”等步骤。其中，数据解析库（如 libjpeg）是巨大的攻击面，而模型本身是可信的。使用 FlexOS，我们可以编译一个 OS，将解析库放在一个独立的、启用了 CFI 和 ASan 的安全隔离舱中，而将模型和网络栈放在同一个高性能隔离舱中，从而以最小的性能代价实现“恰到好处”的安全性。

3.  **LegoOS 思想：实现边缘资源池化**
    * 单个边缘节点资源有限，但边缘节点群（Edge Cluster）的资源总量可观。
    * **展望：** LegoOS 的 **“硬件分解”** 思想可以被借鉴到边缘集群。
    * **应用（边缘加速器共享）：** 昂贵的 GPU/TPU 资源在边缘尤为稀缺。通过一个受 LegoOS 启发的边缘 OS，一个节点上的 CPU 密集型任务可以利用高速边缘网络（如 5G/6G）访问并使用另一个节点上空闲的 GPU。这将极大提高边缘昂贵加速器的利用率，是边缘计算网络系统实现高效资源共享的关键。

综上所述，LegoOS 的硬件分解、DBOS 的数据驱动和 FlexOS 的灵活隔离共同描绘了下一代操作系统的蓝图。在边缘计算和 ML 网络领域，这些思想将融合为一个**以数据为中心、安全可定制、且能感知分解式异构资源的边缘操作系统**。